<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="noindex" />
    <title>Redirecting...</title>
  </head>
  <body>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get("code");
      const state = urlParams.get("state");
      const error = urlParams.get("error");

      if (code && state) {
        // ローカルのOAuthサーバーにリダイレクト
        const redirectUrl = `http://localhost:5001/oauth/callback?code=${code}&state=${state}`;
        window.location.replace(redirectUrl);
      } else if (error) {
        // エラーの場合
        const redirectUrl = `http://localhost:5001/oauth/callback?error=${error}`;
        window.location.replace(redirectUrl);
      } else {
        // パラメータ不足の場合は既存のフォールバック
        window.location.replace("https://mei0001.github.io/notion-auth-demo/fallback.html");
      }
    </script>
    <p>認証処理中...</p>
  </body>
</html>